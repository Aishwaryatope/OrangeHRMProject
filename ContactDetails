package orangehrmproject;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.concurrent.TimeUnit;

import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;
import org.testng.annotations.AfterTest;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;

public class ContactDetails {
	 public WebDriver driver;
	    
	    @BeforeTest
	    public void System() {
	    	System.setProperty("webdriver.chrome.driver", "C:\\Users\\Sumit\\Downloads\\chromedriver-win64\\chromedriver-win64\\chromedriver.exe");
	    	 driver = new ChromeDriver();
	    	 driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);
	    	 
	    }
	    @Test(priority=1,groups="loginpage")
	    public void loginpageTest() {
	    	driver.get( "https://opensource-demo.orangehrmlive.com/web/index.php/auth/login");
	    	driver.manage().window().maximize();
	    	FileInputStream d = null;
	    	try {

				d = new FileInputStream("C:\\Users\\Sumit\\Desktop\\orange.xlsx");
			} catch (FileNotFoundException e) {
			}
	    	
				XSSFWorkbook wb = null;
			try {	
					wb = new XSSFWorkbook(d);
			} catch (IOException e) {
				
			}
				 	
			XSSFSheet ws=wb.getSheet("Sheet1");
				    	
			//Username
	    	String name=ws.getRow(1).getCell(1).getStringCellValue();
	    	String username=ws.getRow(1).getCell(1).getStringCellValue();
	    	driver.findElement(By.xpath(name)).sendKeys(username);
	    	
	    	//Password
	    	String pwd=ws.getRow(2).getCell(1).getStringCellValue();
	    	String pwd1=ws.getRow(2).getCell(2).getStringCellValue();
	    	driver.findElement(By.xpath(pwd)).sendKeys(pwd1);
	    	
	    	//Login Button
	    	String btn=ws.getRow(3).getCell(1).getStringCellValue();
	    	driver.findElement(By.xpath(btn)).click();
	    	try {
				Thread.sleep(3000);
			} catch (InterruptedException e) {
				
			}
			}
	  	 @Test(priority = 2,groups ="contactdetails") 	    	
				public void Contactdetails () {  	
				    	
	  		 FileInputStream d = null;
	 		
		    	try {
				
					d = new FileInputStream("C:\\Users\\Sumit\\Desktop.orange.xlsx");
				} catch (FileNotFoundException e) {
					
				
				}
		    	
					XSSFWorkbook wb = null;
				try {	
						wb = new XSSFWorkbook(d);
				} catch (IOException e) {
					
					
				}
		    	XSSFSheet ws=wb.getSheet("Sheet1");
		   	//My Info page
		    	String myinfo=ws.getRow(5).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(myinfo)).click();	 
		    	driver.manage().timeouts().implicitlyWait(1000, TimeUnit.SECONDS);
		    
		    //Address	
	  		 //Street1
		    	String street1=ws.getRow(29).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(street1)).click();
		    	String st1=ws.getRow(29).getCell(2).getStringCellValue();
		    	driver.findElement(By.xpath(street1)).sendKeys(st1);
		    	driver.manage().timeouts().implicitlyWait(3000, TimeUnit.SECONDS);
		    	
	  		//Street2 
		    	String street2=ws.getRow(30).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(street2)).click();
		    	String st2=ws.getRow(30).getCell(2).getStringCellValue();
		    	driver.findElement(By.xpath(street2)).sendKeys(st2);
		    	driver.manage().timeouts().implicitlyWait(3000, TimeUnit.SECONDS);
	  		 
	  		//city 
		    	String city=ws.getRow(31).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(city)).click();
		    	String ct=ws.getRow(31).getCell(2).getStringCellValue();
		    	driver.findElement(By.xpath(city)).sendKeys(ct);
		    	driver.manage().timeouts().implicitlyWait(3000, TimeUnit.SECONDS);
	  		 
	  		//State 
		    	String state=ws.getRow(32).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(state)).click();
		    	String st=ws.getRow(32).getCell(2).getStringCellValue();
		    	driver.findElement(By.xpath(state)).sendKeys(st);
		    	driver.manage().timeouts().implicitlyWait(3000, TimeUnit.SECONDS);
	  		 
		    //Zip	
		    	String zip=ws.getRow(33).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(zip)).click();
		    	String code=ws.getRow(33).getCell(2).getStringCellValue();
		    	driver.findElement(By.xpath(zip)).sendKeys(code);
		    	driver.manage().timeouts().implicitlyWait(3000, TimeUnit.SECONDS);
		    	
		    //Country	
		    	String country=ws.getRow(34).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(country)).click();
		    	driver.manage().timeouts().implicitlyWait(3000, TimeUnit.SECONDS);
		    
		    //	Home
		    	String home=ws.getRow(35).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(home)).click();
		    	String homeno=ws.getRow(35).getCell(2).getStringCellValue();
		    	driver.findElement(By.xpath(home)).sendKeys(homeno);
		    	driver.manage().timeouts().implicitlyWait(3000, TimeUnit.SECONDS);
	  		 
	  		 //mobile
		    	String mobile=ws.getRow(36).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(mobile)).click();
		    	String mob_no=ws.getRow(36).getCell(2).getStringCellValue();
		    	driver.findElement(By.xpath(mobile)).sendKeys(mob_no);
		    	driver.manage().timeouts().implicitlyWait(3000, TimeUnit.SECONDS);
	  		 
	  		//work 
		    	String work=ws.getRow(37).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(work)).click();
		    	String work_no=ws.getRow(37).getCell(2).getStringCellValue();
		    	driver.findElement(By.xpath(work)).sendKeys(work_no);
		    	driver.manage().timeouts().implicitlyWait(3000, TimeUnit.SECONDS);
	  		 
	  		 //work email
		    	String workemail=ws.getRow(38).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(workemail)).click();
		    	String email=ws.getRow(38).getCell(2).getStringCellValue();
		    	driver.findElement(By.xpath(workemail)).sendKeys(email);
		    	driver.manage().timeouts().implicitlyWait(3000, TimeUnit.SECONDS);
	  		 
	  		 //other email
		    	String otheremail=ws.getRow(39).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(otheremail)).click();
		    	String o_email=ws.getRow(39).getCell(2).getStringCellValue();
		    	driver.findElement(By.xpath(otheremail)).sendKeys(o_email);
		    	driver.manage().timeouts().implicitlyWait(3000, TimeUnit.SECONDS);
		    	
		    //save contact
		    	String contact_details_save=ws.getRow(40).getCell(1).getStringCellValue();
		    	driver.findElement(By.xpath(contact_details_save)).click();
		    	driver.manage().timeouts().implicitlyWait(1000, TimeUnit.SECONDS);
		    	
	  	 }

		    	 @AfterTest
				 public void exit() {
				
				 driver.close();	
		    	 	
		    	
	  		 
			}
	    }
